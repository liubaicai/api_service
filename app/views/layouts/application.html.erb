<!DOCTYPE html>
<html>
<head>
	<title>菜园子 -刘白菜的个人博客</title>
	<link href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
	<link href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.css" rel="stylesheet">
	<link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.css" rel="stylesheet">
	<link href="//cdn.bootcss.com/summernote/0.8.1/summernote.css" rel="stylesheet">
	<link href="/css/highlightstyles/vs.css" rel="stylesheet">
	<link href="/css/app.css" rel="stylesheet">
	<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0" />
	<%= csrf_meta_tags %>
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<img class="navbar-brand img-responsive" src="/images/sitelogo_w.svg">
				<a class="navbar-brand" href="/">菜园子</a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<!--<li class="active"><a href="/">主页</a></li>-->
					<% get_categories.each do |category| %>
						<li class="active">
							<%=link_to category.name, category %>
						</li>
					<% end %>
				</ul>
			</div><!--/.nav-collapse -->
		</div>
	</div>

	<div class="page">
		<div class="container">
			<div class="col-md-8 col-md-push-4">
				<% if flash[:notice] %>
				<p class="alert alert-success"><%= flash[:notice] %>
				<% end %>
				<% if flash[:error] %>
				<p class="alert alert-warning"><%= flash[:error] %>
				<% end %>
				
				<div>
					<%= yield %>
				</div>
				

			</div>
			<div class="col-md-4 col-md-pull-8 bc-slide">
				<div class="row bc-slide-item">
					<img class="img-responsive center-block" src="/images/sitelogo.svg" alt="刘白菜">
				</div>
				<div class="row bc-slide-item">
					<div>
						风恶依然清白容
						<br>
						霜欺雪覆倒如钟
						<br>
						知心解我芊芊叶
						<br>
						永葆玲珑为尔忠
					</div>
				</div>
				<div class="row bc-slide-item">
					<h5 class="bc-slide-item-header">链接</h5>
					<ul>
					<% get_links.each do |link| %>
						<li class="active">
							<a href="<%= link.url %>" target="_blank"><%= link.title %></a>
						</li>
					<% end %>
					</ul>
				</div>
				<div class="row bc-slide-item">
					<%= raw get_slide_content %>
				</div>
				<div class="row bc-slide-item">
					<h5 class="bc-slide-item-header">功能</h5>
					<ul>
						<li><a href="/articles/new">发表</a></li>
						<li><a href="/manager">管理</a></li>
					</ul>
				</div>
			</div>
		</div><!-- /.container -->
	</div>

	
	<footer class="bc-footer">
		<div class="container">
			<p>Powerby<a href="http://weibo.com/liubaicai" target="_blank">@刘白菜</a>，项目源码托管于<a href="https://github.com/liubaicai/baicai_rails_blog" target="_blank">GitHub</a></p>
			<p>京ICP备14022168号</p>
		</div>
	</footer>

	<script src="//cdn.bootcss.com/jquery/2.2.1/jquery.js"></script>
	<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.js"></script>
	<script src="/js/rails.js"></script>
	<script src="/js/summernote.js"></script>
	<script src="/js/summernote-ext-code.js"></script>
	<script src="/js/highlight.pack.js"></script>
	<script>
		$(document).ready(function() {
			$('pre').each(function(i, block) {
    				hljs.highlightBlock(block);
  			});
			$('#summernote').summernote({
				height: "300px",
				callbacks: {
					onImageUpload: function(files) {
						var $editor = $(this);
						var data = new FormData();
						data.append('fileup', files[0]);
						$.ajax({
							url: '/image/upload',
							method: 'POST',
							// xhr: function() {
							// 	var myXhr = $.ajaxSettings.xhr();
							// 	if (myXhr.upload) myXhr.upload.addEventListener('progress',progressHandlingFunction, false);
							// 	return myXhr;
							// },
							data: data,
							processData: false,
							contentType: false,
							success: function(url) {
								$editor.summernote('insertImage', url);
							}
						});
					}
				}
			});
		});
	</script>
</body>
</html>
